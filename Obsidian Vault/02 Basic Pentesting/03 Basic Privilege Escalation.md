<span style="color:#ed8207">This guide assumes that you have established a good reverse shell with the guides</span> [[01 Basic Reverse Shell]] <span style="color:#ed8207">and</span>  [[02 Upgrading The Shell]]

A key term to be aware of before we go:

suid (set user ID): is a special permission in Unix-like operating systems (including Linux) that can be assigned to executable files. When a file has the setuid permission, it allows the user who runs the file to temporarily gain the permissions of the file's owner rather than the permissions of the user who executed the file. When you have these kind of files and can manipulate them, you will gain priv esc. When an executable file has the setuid permission and is executed, the process runs with the permissions of the file's owner, not the user who executed it. This can be useful for allowing regular users to perform tasks that require elevated privileges without giving them permanent access to those privileges.

1. ## Finding SUIDS
So we've established how suid files will make our lives very easy for priv-esc. So... how do we find them. Well, the find command in conjunction with some arguments will get us there hopefully. 

The #finding-suids command we will use is <span style="color:#00b050">find / -perm -u=s -type f 2>/dev/null | xargs ls -l</span> (please refer to the link for a breakdown) and an output like this should come out. 
![[Pasted image 20231210202409.png]]These are all "suid" files, but what do all these letters and numbers mean? Let's take the first one and break it down.
![[Pasted image 20231210202543.png]]
- **-rwsr-xr-x:** This represents the file's permissions.

1. The first character (-) indicates that it is a regular file.
2. The next three characters (rws) indicate the file has read, write, and setuid permissions for the owner.
3. The next three characters (r-x) indicate read and execute permissions for the group.
4. The last three characters (r-x) indicate read and execute permissions for others (non-owner).

- **1 root root:** This part indicates the file's owner and group.

1. The number 1 indicates that this file is linked to (or is) a single inode (a data structure on a filesystem).
2. The first root is the owner of the file.
3. The second root is the group associated with the file.

- **16712:** This is the file's size in bytes.
- **Jan 31 2002:** This indicates the date when the file was last modified or created.
- **/opt/admin:** This is the path to the file on the filesystem.

Putting it all together, the file /opt/admin is a regular file with setuid permissions. The setuid permission is indicated by the s in the owner's permission set (rws). This means that when this file is executed, it will run with the permission of the owner (root), potentially allowing the user who runs it to perform actions with elevated privileges.

2. ## Exploring Suid Directories & Files
Now that we have some files and directories to work with, let’s explore the one that we saw above. So we [[Basic command]] <span style="color:#00b050">cd</span> into the directory and <span style="color:#00b050">cat</span> the file and we get something like this:
![[Pasted image 20231210202810.png]]
So this looks like a program that has two libraries (<stdio.h> & <unistd.h> and then code to execute a program. The program itself if you look at the language, can be inferred that it is using “suid” to make a shell that operates at a root level.

3. ## Executing the Root Shell
So how do we execute this file? We start by using the [[Basic command]] of "<span style="color:#00b050">ls -al</span>" to list out all files, even hidden ones. and it will output something like this: 
![[Pasted image 20231210203345.png]]
“admin” is the only real file that could be executable, but we can’t as it is a binary file (feel free to try) so we use the [[Basic command]] of <span style="color:#00b050">./</span> which allows even binary executables to run, in fact this operator is generally used for executable files. **USE ./admin and you should see no error and a the next command line ready to be input.**
![[Pasted image 20231210203554.png]]
<span style="color:#ed8207">Note: you would never actually see this in the real world, this is basically a backdoor that is in plain site.</span>

After you have executed ./admin, you’ve now created a root shell. Type in “id” and you should see that you are now a root user. Which is awesome. Now just follow the [[02 Upgrading The Shell]] guide or the [[Shell Upgrade Command]] page to re-upgrade this root shell and you're all set to start exploiting the data you find. 